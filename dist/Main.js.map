{"version":3,"sources":["../Main.js"],"names":["Main","canvas","document","getElementById","ctx","getContext","dataStore","DataStore","getInstance","director","Director","loader","ResourceLoader","create","onLoaded","onResourceFirstLoaded","map","res","init","isGameOver","put","BackGround","Land","Birds","StartButton","registerEvent","createPencil","run","addEventListener","e","preventDefault","console","log","birdsEvent"],"mappings":";;;;;;;qjBAAA;;AAEA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;IAEaA,I,WAAAA,I;AACT,oBAAc;AAAA;;AAAA;;AACV,aAAKC,MAAL,GAAcC,SAASC,cAAT,CAAwB,aAAxB,CAAd;AACA,aAAKC,GAAL,GAAW,KAAKH,MAAL,CAAYI,UAAZ,CAAuB,IAAvB,CAAX;AACA,aAAKC,SAAL,GAAiBC,qBAAUC,WAAV,EAAjB;AACA,aAAKC,QAAL,GAAgBC,mBAASF,WAAT,EAAhB;AACA,YAAMG,SAASC,+BAAeC,MAAf,EAAf;AACAF,eAAOG,QAAP,CAAgB;AAAA,mBAAO,MAAKC,qBAAL,CAA2BC,GAA3B,CAAP;AAAA,SAAhB;AAGH;;;;8CAEqBA,G,EAAK;AACvB,iBAAKV,SAAL,CAAeF,GAAf,GAAqB,KAAKA,GAA1B;AACA,iBAAKE,SAAL,CAAeW,GAAf,GAAqBD,GAArB;AACA,iBAAKE,IAAL;AAGH;;;+BAEM;AACH;AACA,iBAAKT,QAAL,CAAcU,UAAd,GAA2B,KAA3B;AACA,iBAAKb,SAAL,CACKc,GADL,CACS,SADT,EACoB,EADpB,EAEKA,GAFL,CAES,YAFT,EAEuBC,sBAFvB,EAGKD,GAHL,CAGS,MAHT,EAGiBE,UAHjB,EAIKF,GAJL,CAIS,OAJT,EAIiBG,YAJjB,EAKKH,GALL,CAKS,aALT,EAKuBI,wBALvB;AAMA,iBAAKC,aAAL;AACA;AACA,iBAAKhB,QAAL,CAAciB,YAAd;AACA,iBAAKjB,QAAL,CAAckB,GAAd;AACH;;;wCACc;AAAA;;AACX,iBAAK1B,MAAL,CAAY2B,gBAAZ,CAA6B,YAA7B,EAA0C,aAAG;AACzC;AACAC,kBAAEC,cAAF;AACA,oBAAG,OAAKrB,QAAL,CAAcU,UAAjB,EAA4B;AACxB,2BAAKD,IAAL;AACAa,4BAAQC,GAAR,CAAY,MAAZ;AACH,iBAHD,MAGK;AACD,2BAAKvB,QAAL,CAAcwB,UAAd;AACH;AACJ,aATD;AAUH","file":"Main.js","sourcesContent":["//初始化整个游戏的精灵，作为游戏开始的入口\r\n\r\nimport {ResourceLoader} from \"./js/base/ResourceLoader.js\";\r\nimport {Director} from \"./js/Director.js\";\r\nimport {BackGround} from \"./js/runtime/BackGround.js\";\r\nimport {Land} from \"./js/runtime/Land.js\";\r\nimport {DataStore} from \"./js/base/DataStore.js\";\r\nimport {Birds} from \"./js/player/Birds.js\";\r\nimport {StartButton} from \"./js/player/StartButton.js\";\r\n\r\nexport class Main {\r\n    constructor() {\r\n        this.canvas = document.getElementById('game_canvas');\r\n        this.ctx = this.canvas.getContext('2d');\r\n        this.dataStore = DataStore.getInstance();\r\n        this.director = Director.getInstance();\r\n        const loader = ResourceLoader.create();\r\n        loader.onLoaded(map => this.onResourceFirstLoaded(map));\r\n\r\n\r\n    }\r\n\r\n    onResourceFirstLoaded(map) {\r\n        this.dataStore.ctx = this.ctx;\r\n        this.dataStore.res = map;\r\n        this.init();\r\n\r\n\r\n    }\r\n\r\n    init() {\r\n        //首先重置游戏是没有结束的\r\n        this.director.isGameOver = false;\r\n        this.dataStore\r\n            .put('pencils', [])\r\n            .put('background', BackGround)\r\n            .put('land', Land)\r\n            .put('birds',Birds)\r\n            .put('startButton',StartButton);\r\n        this.registerEvent();\r\n        //要在游戏逻辑运行之前\r\n        this.director.createPencil();\r\n        this.director.run();\r\n    }\r\n    registerEvent(){\r\n        this.canvas.addEventListener('touchstart',e=>{\r\n            //屏蔽掉JS的事件冒泡\r\n            e.preventDefault();\r\n            if(this.director.isGameOver){\r\n                this.init();\r\n                console.log('游戏开始');\r\n            }else{\r\n                this.director.birdsEvent();\r\n            }\r\n        })\r\n    }\r\n}"]}